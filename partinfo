#!/usr/pubsw/bin/perl

die "only one argument allowed\n" unless $#ARGV == 0;
die "not an afssvrN\n" unless $ARGV[0] =~ /afssvr[1-9]/ || $ARGV[0] =~ /gsbafs[1-3]/ || $ARGV[0] =~ /auth[1-3]/;

open(PARTLIST, "/usr/pubsw/bin/vos partinfo $ARGV[0]|");
while (<PARTLIST>) {
  if ( m;Free space on partition (/vicep[a-z]): ([0-9]*) K blocks out of total ([0-9]*);) {
    printf "%-8s %s: %10d %10d %10d %5.2f%% %8.0f\n", 
	   $ARGV[0], $1, $2, $3 - $2, $3, 100*($3-$2)/$3, $2 - 0.2*$3;
  }
  else {
    print "BLURG", $_;
  }
}
close(PARTLIST);
